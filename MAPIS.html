<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 1.2.0" />
  <meta name="viewport" content="initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bootstrap demo document</title>
  <style type="text/css"  class="link">
  /*# sourceURL=madoko.css */
  
  .madoko .toc>.tocblock .tocblock .tocblock {
    margin-left: 2.25em;
  }
  .madoko .toc>.tocblock .tocblock {
    margin-left: 1.5em;
  }
  .madoko .toc-contents>.tocblock>.tocitem {
    font-weight: bold;
  }
  .madoko .toc {
    margin-top: 1em;
  }
  .madoko p.para-continue {
    margin-bottom: 0pt;
  }
  .madoko .para-block+p {
    margin-top: 0pt;
  }
  .madoko ul.para-block, .madoko ol.para-block {
    margin-top: 0pt;
    margin-bottom: 0pt;
  }
  .madoko ul.para-end, .madoko ol.para-end {
    margin-bottom: 1em;
  }
  .madoko dl {
    margin-left: 0em;
  }
  .madoko blockquote {
    font-style: italic;
  }
  .madoko a.localref {
    text-decoration: none;
  }
  .madoko a.localref:hover {
    text-decoration: underline;
  }
  .madoko .footnotes {
    font-size: smaller;
    margin-top: 2em;
  }
  .madoko .footnotes hr {
    width: 50%;
    text-align: left;
  }
  .madoko .footnote {
    margin-left: 1em;
  }
  .madoko .footnote-before {
    margin-left: -1em;
    width: 1em;
    display: inline-block;
  }
  .madoko .align-center, .madoko .align-center>p {
    text-align: center !important;
  }
  .madoko .align-center pre {
    text-align: left;
  }
  .madoko .align-center>* {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .madoko .align-left, .madoko .align-left>p {
    text-align: left !important;
  }
  .madoko .align-left>* {
    margin-left: 0pt !important;
    margin-right: auto !important;
  }
  .madoko .align-right, .madoko .align-right>p {
    text-align: right !important;
  }
  .madoko .align-right>* {
    margin-left: auto !important;
    margin-right: 0pt !important;
  }
  .madoko .align-center>table,
  .madoko .align-left>table,
  .madoko .align-right>table {
    text-align: left !important;
  }
  .madoko .equation-before {
    float: right;
  }
  .madoko .bibitem {
    font-size: smaller;
  }
  .madoko .bibsearch {
    font-size: x-small;
    text-decoration:none;
    color: black;
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  .madoko .block, .madoko .figure, .madoko .bibitem, .madoko .equation, .madoko div.math {
    margin-top: 1ex;
    margin-bottom: 1ex;
  }
  .madoko .figure {
    padding: 0.5em;
    margin-left: 0pt;
    margin-right: 0pt;
  }
  .madoko .hidden {
    display: none;
  }
  .madoko .invisible {
    visibility: hidden;
  }
  .madoko.preview .invisible {
    visibility: visible;
    opacity: 0.5;
  }
  .madoko code.code, .madoko span.code {
    white-space: pre-wrap;
  }
  .madoko hr, hr.madoko {
    border: none;
    border-bottom: black solid 1px;
    margin-bottom: 0.5ex;
  }
  .madoko .framed>*:first-child {
    margin-top: 0pt;
  }
  .madoko .framed>*:last-child {
    margin-bottom: 0pt;
  }
  .madoko ul.list-style-type-dash {
      list-style-type: none !important;
  }
  .madoko ul.list-style-type-dash > li:before {
      content: "\2013";
      position: absolute;
      margin-left: -1em;
  }
  .madoko table.madoko {
    border-collapse: collapse;
  }
  .madoko td, .madoko th {
    padding: 0ex 0.5ex;
    margin: 0pt;
    vertical-align: top;
  }
  .madoko .cell-border-left {
    border-left: 1px solid black;
  }
  .madoko .cell-border-right {
    border-right: 1px solid black;
  }
  .madoko thead>tr:first-child>.cell-line,
  .madoko tbody:first-child>tr:first-child>.cell-line {
    border-top: 1px solid black;
    border-bottom: none;
  }
  .madoko .cell-line, .madoko .cell-double-line {
    border-bottom: 1px solid black;
    border-top: none;
  }
  .madoko .cell-double-line {
    border-top: 1px solid black;
    padding-top: 1.5px !important;
  }
  .madoko .input-mathpre .MathJax_Display {
    text-align: left !important;
  }
  .madoko div.input-mathpre {
    text-align: left;
    margin-top: 1.5ex;
    margin-bottom: 1ex;
  }
  .madoko .math-rendering {
    text-align: left;
    white-space: pre;
    color: gray;
  }
  .madoko .mathdisplay {
    text-align: center;
  }
  .madoko span.math-rendering {
    display:inline-block;
    width:8em;
    overflow-x:auto;
    font-size:70%;
  }
  .madoko span.math-rendering::-webkit-scrollbar {
    width:4px;
  }
  .madoko .pretty table {
    border-collapse: collapse;
  }
  .madoko .pretty td {
    padding: 0em;
  }
  .madoko .pretty td.empty {
    min-width: 1.5ex;
  }
  .madoko .pretty td.expander {
    width: 100em;
  }
  body.madoko, .madoko .serif {
    font-family: Cambria,"Times New Roman","Liberation Serif","Times",serif;
  }
  .madoko .sans-serif {
    font-family: "Calibri", "Optima", sans-serif;
  }
  .madoko .symbol {
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  body.madoko {
    -webkit-text-size-adjust: 100%;       
    text-rendering: optimizeLegibility;
  }
  body.madoko {
    max-width: 88ex; 
    margin: 1em auto;
    padding: 0em 2em;
  }
  body.preview.madoko {
    padding: 0em 1em;
  }
  .madoko p {
    text-align: justify;
  }
  .madoko h1, .madoko h2, .madoko h3, .madoko h4 {
    margin-top: 1.22em;
    margin-bottom: 1ex;
  }
  .madoko h1+p, .madoko h2+p, .madoko h3+p, .madoko h4+p, .madoko h5+p  {
    margin-top: 1ex;
  }
  .madoko h5, .madoko h6 {
    margin-top: 1ex;
    font-size: 1em;
  }
  .madoko h5 {
    margin-bottom: 0.5ex;
  }
  .madoko h5 + p {
    margin-top: 0.5ex;
  }
  .madoko h6 {
    margin-bottom: 0pt;
  }
  .madoko h6 + p {
    margin-top: 0pt;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt,
  .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-family: Consolas,"Andale Mono WT","Andale Mono",Lucida Console,Monaco,monospace,monospace;
    font-size: 0.85em;
  }
  .madoko pre code, .madoko .token-indent {
    font-size: 0.95em;
  }
  .madoko pre code {
    font-family: inherit !important;
  }
  .madoko ol.linenums li {
    background-color: white;
    list-style-type: decimal;
  }
  .madoko .remote {
    background-color: #F0FFF0;
  }
  .madoko .remote + * {
    margin-top: 0pt;
  }
  @media print {
    body.madoko {
      font-size: 10pt;
    }
    @page {
      margin: 1in 1.5in;
    }
  }
  @media only screen and (max-device-width:1024px) {
    body.madoko {
      padding: 0em 0.5em;
    }
    .madoko li {
      text-align: left;
    }
  }
  
    </style>
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"  class="link">
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"  class="link">
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.2.0//bootstrap.min.css"  class="link">
  <style type="text/css"  class="link">
  /*# sourceURL=nav-example.css */
  
  body {
    padding-top: 20px;
  }
  .footer {
    padding-top: 40px;
    padding-bottom: 40px;
    margin-top: 40px;
    border-top: 1px solid #eee;
  }
  .jumbotron {
    text-align: center;
    background-color: transparent;
  }
  .jumbotron .btn {
    padding: 14px 24px;
    font-size: 21px;
  }
  .nav-justified {
    background-color: #eee;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  .nav-justified > li > a {
    padding-top: 15px;
    padding-bottom: 15px;
    margin-bottom: 0;
    font-weight: bold;
    color: #777;
    text-align: center;
    background-color: #e5e5e5; 
    background-image:    -moz-linear-gradient(top, #f5f5f5 0%, #e5e5e5 100%); 
    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f5f5f5), color-stop(100%,#e5e5e5)); 
    background-image: -webkit-linear-gradient(top, #f5f5f5 0%,#e5e5e5 100%); 
    background-image:      -o-linear-gradient(top, #f5f5f5 0%,#e5e5e5 100%); 
    background-image:         linear-gradient(top, #f5f5f5 0%,#e5e5e5 100%); 
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f5f5f5', endColorstr='#e5e5e5',GradientType=0 ); 
    background-repeat: repeat-x; 
    border-bottom: 1px solid #d5d5d5;
  }
  .nav-justified > .active > a,
  .nav-justified > .active > a:hover,
  .nav-justified > .active > a:focus {
    background-color: #ddd;
    background-image: none;
    box-shadow: inset 0 3px 7px rgba(0,0,0,.15);
  }
  .nav-justified > li:first-child > a {
    border-radius: 5px 5px 0 0;
  }
  .nav-justified > li:last-child > a {
    border-bottom: 0;
    border-radius: 0 0 5px 5px;
  }
  @media (min-width: 768px) {
    .nav-justified {
      max-height: 52px;
    }
    .nav-justified > li > a {
      border-right: 1px solid #d5d5d5;
      border-left: 1px solid #fff;
    }
    .nav-justified > li:first-child > a {
      border-left: 0;
      border-radius: 5px 0 0 5px;
    }
    .nav-justified > li:last-child > a {
      border-right: 0;
      border-radius: 0 5px 5px 0;
    }
  }
  @media screen and (min-width: 768px) {
    .masthead,
    .marketing,
    .footer {
      padding-right: 0;
      padding-left: 0;
    }
  }
  
    </style>
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
      <style>
        body.madoko, body.madoko.preview[data-view=full] { 
          padding: 0pt;
          margin: 0pt;
          max-width: 100%;
        }
      </style>
  </head>
<body class="madoko">

<div class="body madoko" style="line-adjust:0">
<div class="container">
<div class="masthead">
<h2 id="sec-han-kan" class="h1 text-muted" data-heading-depth="1" style="display:block">HAN KAN</h2>
<ul class="ul list-star nav nav-justified compact">
<li class="li ul-li list-star-li nav-li nav-justified-li compact-li"><a href="/index.html">Experience</a>
</li>
<li class="li ul-li list-star-li nav-li nav-justified-li compact-li active"><a href="/IPI.html">Research</a>
</li>
<li class="li ul-li list-star-li nav-li nav-justified-li compact-li"><a href="/activities.html">Activities</a>
</li>
<li class="li ul-li list-star-li nav-li nav-justified-li compact-li"><a href="/contact.html">Contact</a></li></ul></div>
<hr  class="madoko" style="display:block">

<ul class="ul list-star compact">
<li class="li ul-li list-star-li compact-li"><a href="/IPI.html">Interferometric Particle Imaging</a>
</li>
<li class="li ul-li list-star-li compact-li"><a href="/X-ray.html">X-ray Phase Imaging</a>
</li>
<li class="li ul-li list-star-li compact-li">Matrix Pinhole Imaging
</li>
<li class="li ul-li list-star-li compact-li"><a href="/3D.html">3D vision</a>
</li></ul>
<h2 id="sec---matrix-pinhole-imaging--" class="h1" data-heading-depth="1" style="display:block"><strong class="strong-star2">Matrix Pinhole Imaging</strong></h2><h3 id="sec-1introduction" class="h2" data-heading-depth="2" style="display:block">1.Introduction</h3>
<p class="p noindent">   Matrix Pinhole Imaging(MAPIS) is the world&#39;s first optical fingerprint technology which can recognize fingerprint
under display(especially cellphone display). I take responsibility for all the work about optics( for I am the only
optical engineer in this company) and some parts of algorithm about image processing. Though I met several problems
and find interesting ways to solve them both in optics and image processing. For I have signed NDA(Non Disclosure 
Agreement), I can&#39;t realize informations about optics publicly. If you are interested in them, feel free to&nbsp;<a href="/contact.html">contact</a> me.
</p>
<div class="center align-center" style="text-align:center">
<p class="p noindent"><img src="images/Mapis-Setup.jpg" title="Mapis Setup" alt="Mapis Setup" data-path="images/Mapis-Setup.jpg" data-linkid="mapis setup" style="width:auto;max-width:90%">
</p></div><h3 id="sec-2a-new-discovery-about-svd" class="h2" data-heading-depth="2" style="display:block">2.A new discovery about SVD</h3>
<p class="p noindent">Here I&#39;d like to share an entirely new discovery about SVD(Singular Value Decomposition). Which makes it easier to remove
the regular noise in an individual image especially in stitched image. And a method to speed it up.
</p><h4 id="sec-1-remove-regular-noise" class="h3" data-heading-depth="3" style="display:block">1) Remove regular noise</h4>
<p class="p noindent">In the our system, or in any other matrix imaging system, when the light intensity distribution is not uniform, the stitched image may has grid
(see Fig.1). To remove this regular grid and inhomogeneous light distribution. We found SVD is nearly a perfect way to solve this problem.
</p>
<div class="center align-center" style="text-align:center">
<p class="p noindent"><img src="images/fp_stitched.png" title="fp_stitched" alt="fp_stitched" data-path="images/fp_stitched.png" data-linkid="fp_stitched" style="width:auto;max-width:100%">
</p>
<p class="p indent">Fig.1. Original image
</p>
<p class="p indent"><img src="images/output.jpg" title="output" alt="output" data-path="images/output.jpg" data-linkid="output" style="width:auto;max-width:100%">
</p>
<p class="p indent">Fig.2. After removing the 1st principle component
</p></div><h4 id="sec-2-a-method-to-speed-it-up" class="h3" data-heading-depth="3" style="display:block">2) A method to speed it up</h4>
<div class="center align-center" style="text-align:center">
<p class="p noindent"><img src="images/Projection.jpg" title="Projection" alt="Projection" data-path="images/Projection.jpg" data-linkid="projection" style="width:auto;max-width:100%">
<img src="images/matrix-line.jpg" title="matrix line" alt="matrix line" data-path="images/matrix-line.jpg" data-linkid="matrix line" style="width:auto;max-width:100%">
</p></div>
<pre class="para-block pre-fenced pre-fenced3 language-javascript lang-javascript javascript colorized" style="display:block"><code>clc;
clear;
img=imread(<span style="color:maroon">&#39;</span><span style="color:maroon">fp_stitched.png</span><span style="color:maroon">&#39;</span>);
%   img=rgb2gray(img);
 img=<span style="color:blue">double</span>(img);
 [m,n]=size(img);
<span style="color:blue">for</span> y=<span class="constant" style="color:purple">1</span>:n
     A(y)=sum(img(<span class="constant" style="color:purple">1</span>:m,y));
end
y=<span class="constant" style="color:purple">1</span>:n;
figure
subplot(<span class="constant" style="color:purple">212</span>),plot(y,A(y));
title(<span style="color:maroon">&#39;</span><span style="color:maroon">Column projection</span><span style="color:maroon">&#39;</span>);
<span style="color:blue">for</span> x=<span class="constant" style="color:purple">1</span>:m
    T(x)=sum(img(x,:));
end
x=<span class="constant" style="color:purple">1</span>:m;
subplot(<span class="constant" style="color:purple">211</span>),plot(x,T(x));
title(<span style="color:maroon">&#39;</span><span style="color:maroon">Row projection</span><span style="color:maroon">&#39;</span>);
figure,imagesc(img);
colormap(gray);
title(<span style="color:maroon">&#39;</span><span style="color:maroon">Original image</span><span style="color:maroon">&#39;</span>)
[U,S,V]=svd(img);
<span style="color:blue">for</span> i=<span class="constant" style="color:purple">1</span>
    S(i,i)=<span class="constant" style="color:purple">0</span>;
end
img2=U*S*V<span style="color:red">&#39;;</span>
figure,imagesc(img2);
colormap(gray);
img4=mat2gray(img2);
imwrite(img4,<span style="color:maroon">&#39;</span><span style="color:maroon">output.jpg</span><span style="color:maroon">&#39;</span>);
M=U(:,<span class="constant" style="color:purple">1</span>);
N=V(:,<span class="constant" style="color:purple">1</span>);
M=abs(M);
N=abs(N);
figure,
i=<span class="constant" style="color:purple">1</span>:m;
subplot(<span class="constant" style="color:purple">211</span>),plot(i,M(i));
title(<span style="color:maroon">&#39;</span><span style="color:maroon">First row of U</span><span style="color:maroon">&#39;</span>) 
hold on;
j=<span class="constant" style="color:purple">1</span>:n;
subplot(<span class="constant" style="color:purple">212</span>),plot(j,N(j));
title(<span style="color:maroon">&#39;</span><span style="color:maroon">First column of VT </span><span style="color:maroon">&#39;</span>)
figure,imagesc(img2);
colormap(gray);
A1=A./norm(A);
T1=T/norm(T);
T1=T1<span style="color:red">&#39;;</span>
SS=kron(A1,T1);
sumSS=sum(SS);
sumyuan=sum(img2);
DD=sumyuan/sumSS;
DD1=S(<span class="constant" style="color:purple">1</span>,<span class="constant" style="color:purple">1</span>);
DD2=SS*DD;
figure,imagesc(DD2);
colormap(gray);
img3=img2-DD2;
figure,imagesc(img3);
colormap(gray);
}</code></pre></div><span data-line=""></span></div>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</html>
